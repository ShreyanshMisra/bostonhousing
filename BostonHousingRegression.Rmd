---
title: "Multiple Linear Regression on Boston Housing Dataset"
author: ""
date: "`r Sys.Date()`"
output:
  pdf_document:
    number_sections: true
---

```{r include=FALSE, messages=FALSE}
library(knitr)
library(ggplot2)
library(caret)
library(ggplot2)
library(tidyr)
library(dplyr)
```

# Introduction

Introduce the model, data background, related knowledge, and R packages that you have used and result you have gotten in this essay.

# Data description

```{r }
housing.df <- read.csv("boston_house_prices.csv")

nrow(housing.df) # number of rows
sum(is.na(housing.df)) # missing data
```

## Dataset

This dataset contains information about 506 neighborhoods in Boston, collected by the U.S Census Service in 1970 census. There are 506 records and 13 variables in the dataset. From an initial analysis, there were no missing data points.

## Variables
- crim: per capita crime rate by town
- zn: proportion of residential land zoned for lots over 25,000 sq.ft
- indus: proportion of non-retail business acres per town
- chas: Charles River dummy variable (= 1 if tract bounds river; 0 otherwise)
- nox: nitric oxides concentration (parts per 10 million)
- rm: average number of rooms per dwelling
- age: proportion of owner-occupied units built prior to 1940
- dis: weighted distances to five Boston employment centres
- rad: index of accessibility to radial highways
- tax: full-value property-tax rate per USD 10,000
- ptratio: pupil-teacher ratio by town
- lstat: percentage of lower status of the population
- medv: median value of owner-occupied homes in USD 1000â€™s

## Outlier Detection

```{r }
summary(housing.df)
```

```{r }
housing_box <- housing.df %>%
  pivot_longer(cols = everything(), names_to = "variable", values_to = "value")

ggplot(housing_box, aes(x = "", y = value)) +
  geom_boxplot(fill = "steelblue") +
  theme_minimal() +
  facet_wrap(~ variable, scales = "free_y") +
  theme(axis.text.x = element_blank(), axis.ticks.x = element_blank())
```

```{r }
head(housing.df, 5)
```


# Analysis

You should cut your data set into train set and test set and tell us the data size for train set and data size for test set. You must use the diagonal plot to verify the assumptions, and show us the coding for computation, Pictures, tables, and Interpretation.

```{r}
set.seed(123)

split <- 0.7

trainIndex <- createDataPartition(housing.df$medv, p = split)
trainIndex <- unlist(trainIndex)

train <- housing.df[trainIndex, ]
test <- housing.df[-trainIndex, ]
```

```{r}
nrow(train)
nrow(test)
```

```{r }
model <- lm(medv ~ . , data = train)
summary(model)
```

```{r }
model_significant <- lm(medv ~ crim + zn + chas + nox + rm + dis + rad + tax + ptratio + lstat, data = train)
summary(model_significant)
```

# Model Evaluation and Prediction

You should base on the training set you should hav gotten a model in (3), then you must use subset selection and all necessary test to verify the final model that you get is the best model (Model assessment and model accuracy) and use it to make a prediction

```{r }
predictions <- predict(model_significant, newdata = test)
actual <- test$medv

mae <- mean(abs(predictions - actual)) # MAE
mse <- mean((predictions - actual)^2) # MSE
rmse <- sqrt(mse) # RMSE

mae
mse
rmse
```

# Conclusion

The summary your all your work and results in this part and point out positive side of your model, negative side of your model and possible future work or any factors that affect your model accuracy.


# References
- https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html
- https://www.sthda.com/english/articles/40-regression-analysis/168-multiple-linear-regression-in-r/